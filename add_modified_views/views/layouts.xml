<?xml version="1.0"?>
<odoo>
  
<data>
<odoo>
    <data>
<record id="seq_hr_expense_advance" model="ir.sequence">
    <field name="name">hr.expense.advance.sequence</field>
    <field name="code">hr.expense.advance</field>
    <field name="prefix">ADV/</field>
    <field name="padding">4</field>
</record>
    <record model="ir.ui.view" id="view_hr_expense_form">
    <field name="name">hr.expense.form</field>
    <field name="model">hr.expense</field>
    <field name="inherit_id" ref="hr_expense.hr_expense_view_form"/>
    <field name="arch" type="xml">
        <xpath expr="//field[@name='account_id']" position="after">
            <field name="advance_id" attrs="{'invisible': [('payment_mode', '!=', 'advance')]}" domain="[('state','=','paid')]"/>
            <field name="amount_advanced" attrs="{'invisible': [('payment_mode', '!=', 'advance')]}"/>
            <field name="amount_to_recover" attrs="{'invisible': [('payment_mode', '!=', 'advance')]}"/>
        </xpath>
    </field>
</record>


       <record model="ir.ui.view" id="view_hr_expense_advance_form">
    <field name="name">hr.expense.advance.form</field>
    <field name="model">hr.expense.advance</field>
    <field name="arch" type="xml">
        <form string="Advance">
          <header>
             <button name="action_paid" states="draft" string="Payé" type="object" class="oe_highlight" />
             <button name="action_close" states="paid" string="Clôturé" type="object" class="oe_highlight" />
               <field name="state" widget="statusbar"/>
          </header>
            <group>
                <field name="name"/>
                <field name="employee_id"/>
<!--                 <field name="journal_id"/> -->
                <field name="amount"/>
              <field name="remaining_amount"/>
<!--                 <field name="date"/>
                <field name="notes"/> -->
             
                <field name="expense_ids" widget="one2many_list">
                    <tree string="Expenses">
                        <field name="name"/>
                        <field name="employee_id"/>
                        <field name="product_id"/>
                        <field name="quantity"/>
                        <field name="unit_amount"/>
                        <field name="tax_ids"/>
                        <field name="total_amount"/>
                       <field name="amount_advanced" />
                <field name="amount_to_recover" />
                    </tree>
                </field>
               
            </group>
        </form>
    </field>
</record>

<!-- Vue arborescence -->
<record model="ir.ui.view" id="view_hr_expense_advance_tree">
    <field name="name">hr.expense.advance.tree</field>
    <field name="model">hr.expense.advance</field>
    <field name="arch" type="xml">
        <tree string="Advances">
            <field name="name"/>
            <field name="employee_id"/>
<!--             <field name="journal_id"/> -->
            <field name="amount"/>
             <field name="remaining_amount"/>
<!--             <field name="date"/>
            <field name="notes"/> -->
            <field name="state" widget="statusbar"/>
        </tree>
    </field>
</record>

<!-- Action -->
<record model="ir.actions.act_window" id="action_hr_expense_advance">
    <field name="name">Advances</field>
    <field name="res_model">hr.expense.advance</field>
    <field name="view_mode">tree,form</field>
    <field name="help" type="html">
        <p class="oe_view_nocontent_create">
            Create an advance request.
        </p>
    </field>
</record>

<!-- Menu -->

<menuitem id="menu_hr_expense_advance_main" name="Advances" parent="hr_expense.menu_hr_expense_root" action="action_hr_expense_advance"/>


    </data>
</odoo>
    </data>     
</odoo>



